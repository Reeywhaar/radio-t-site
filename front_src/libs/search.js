'use strict';var ANIMATION_TIME=300;var MONTHS=['\u042F\u043D\u0432','\u0424\u0435\u0432','\u041C\u0430\u0440','\u0410\u043F\u0440','\u041C\u0430\u0439','\u0418\u044E\u043D','\u0418\u044E\u043B','\u0410\u0432\u0433','\u0421\u0435\u043D','\u041E\u043A\u0442','\u0414\u0435\u043A'];window.addEventListener('DOMContentLoaded',function(){initStyles();initMarkup();initSearch()});function initSearch(){var searchWindow=document.getElementById('search-window');var searchClose=document.getElementById('search-window__close');var form=document.querySelector('nav form');searchClose.addEventListener('click',closeSearch);window.addEventListener('keyup',function(e){if(e.keyCode===27&&searchWindow.style.display!=='none'){e.preventDefault();closeSearch()}});form.addEventListener('submit',function(e){e.preventDefault();search(encodeURIComponent(document.querySelector('input.search').value))})}function search(searchString){var xhr=new XMLHttpRequest;xhr.open('GET','https://radio-t.com/site-api/search?q='+searchString);xhr.send();openSearch();xhr.onreadystatechange=function(){if(xhr.readyState!==4)return;if(xhr.status!==200){setSearchContent({body:'\u0427\u0442\u043E-\u0442\u043E \u043F\u043E\u0448\u043B\u043E \u043D\u0435 \u0442\u0430\u043A. \u041F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437.',mode:'error'})}else{setSearchContent(buildSearchObject(xhr.responseText))}}}function buildSearchObject(json){var data=JSON.parse(json||'null');if(!data||!data.length){return{body:'\u0423\u0432\u044B, \u043D\u0438\u0447\u0435\u0433\u043E \u043D\u0435 \u043D\u0430\u0448\u043B\u043E\u0441\u044C.',mode:'error'}}return{body:data.reduce(function(acc,_ref){var body=_ref.body,date=_ref.date,url=_ref.url,title=_ref.title;var dateObj=new Date(date);var dateStr=MONTHS[dateObj.getMonth()]+' '+('0'+dateObj.getDate().toString()).substr(-2)+', '+dateObj.getFullYear()+' - '+dateObj/1000;return'\n        '+acc+'\n        <article>\n          <header>\n            <h1 class="entry-title"><a href="'+url+'">'+title+'</a></h1>\n            \n            <p class="meta">\n              <time datetime="'+date+'">'+dateStr+'</time> | <a href="'+url+'#remark42"><b><span class="remark42__counter" data-url="'+url+'"></span> comments</b></a>\n            </p>\n          </header>\n        \n          <div class="entry-content">'+body+'</div>\n        </article>\n      '},'')}}function setSearchContent(_ref2){var _ref2$body=_ref2.body,body=_ref2$body===undefined?'':_ref2$body,mode=_ref2.mode;var searchContent=document.getElementById('search-window__content');if(mode==='error'){body='<div class="search-window__error">'+body+'</div>'}searchContent.innerHTML=body;setTimeout(function(){initAudio(searchContent);initRemark42()},100)}function initAudio(container){var audio=container.getElementsByTagName('audio');audiojs.createAll({},audio)}function initRemark42(){(function(){var s=document.createElement('script');s.src='https://remark42.radio-t.com/web/counter.js';s.type='text/javascript';s.async=true;(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(s)})()}function openSearch(){var searchWindow=document.getElementById('search-window');disableBodyScroll();searchWindow.style.display='block';setTimeout(function(){searchWindow.style.opacity=1})}function closeSearch(){var searchWindow=document.getElementById('search-window');var searchContent=document.getElementById('search-window__content');enableBodyScroll();searchWindow.style.opacity=0;setTimeout(function(){searchWindow.style.display='none';searchContent.innerHTML=''},ANIMATION_TIME)}function initMarkup(){var html='\n    <div class="search-window" id="search-window">\n      <div class="search-window__close" id="search-window__close">\xD7</div>\n      <div class="search-window__body">\n        <div class="search-window__content" id="search-window__content"></div>\n      </div>\n    </div>\n  ';var body=document.body||document.querySelector('body');var searchWindow=document.createElement('div');searchWindow.innerHTML=html;body.appendChild(searchWindow)}function initStyles(){var css='\n    .search-window {\n      display: none;\n      position: fixed;\n      z-index: 10;\n      top: 0;\n      bottom: 0;\n      left: 0;\n      right: 0;\n      opacity: 0;\n      background: rgba(255, 255, 255, .75);\n      transition: opacity '+ANIMATION_TIME+'ms ease-out;\n    }\n    \n    .search-window__body {\n      position: fixed;\n      top: 50%;\n      left: 0;\n      right: 0;\n      transform: translateY(-50%);\n      box-sizing: border-box;\n      max-height: calc(100% - 60px);\n      max-width: 900px;\n      padding: 40px 40px;\n      margin: 0 auto;\n      background: #fff;\n      overflow: auto;\n      border: 2px solid #efefef;\n      box-shadow: 5px 5px 25px #efefef;\n    }\n    \n    .search-window__close {\n      position: absolute;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      left: 0;\n      padding: 10px;\n      font-size: 40px;\n      line-height: 40px;\n      text-align: right;\n      color: #777;\n      cursor: pointer;\n    }\n    \n    .search-window__close:hover {\n      color: #000;\n    }\n    \n    .search-window__content article + article {\n      margin-top: 30px;\n    }\n    \n    @media (max-width: 1000px) {\n      .search-window__close {\n        position: fixed;\n        z-index: 1;\n        left: auto;\n        bottom: auto;\n        padding: 0 5px;\n      }\n      \n      .search-window__body {\n        top: 0;\n        bottom: 0;\n        max-height: 100%;\n        max-width: 100%;\n        transform: none;\n      }\n    }\n    \n    @keyframes loadAnimation {\n      0% {\n        content: \'.\';\n      }\n      33% {\n        content: \'..\';\n      }\n      66% {\n        content: \'...\';\n      }\n      100% {\n        content: \'....\';\n      }\n    }\n    \n    .search-window__content:empty::before {\n      content: \'\';\n      display: block;\n      animation: loadAnimation .75s linear infinite alternate;\n      text-align: center;\n      font-size: 20px;\n    }\n    \n    .search-window__error {\n      color: #d00000;\n      padding: 100px 0;\n      text-align: center;\n    }\n    \n    .entry-content::after {\n      content: \'\';\n      display: block;\n      clear: both;\n    }\n  ';var head=document.head||document.querySelector('head');var styles=document.createElement('style');styles.innerHTML=css;head.appendChild(styles)}function enableBodyScroll(){if(document.readyState==='complete'){document.body.style.position='';document.body.style.overflowY='';document.body.style.left='';document.body.style.right='';if(document.body.style.marginTop){var scrollTop=-parseInt(document.body.style.marginTop,10);document.body.style.marginTop='';window.scrollTo(window.pageXOffset,scrollTop)}}else{window.addEventListener('load',enableBodyScroll)}}function disableBodyScroll(){var _ref3=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},savePosition=_ref3.savePosition;if(document.readyState==='complete'){if(document.body.offsetHeight>window.innerHeight){if(savePosition)document.body.style.marginTop='-'+window.pageYOffset+'px';document.body.style.position='fixed';document.body.style.left=0;document.body.style.right=0;document.body.style.overflowY='scroll'}}else{window.addEventListener('load',disableBodyScroll)}}